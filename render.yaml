services:
  - type: static
    name: capstone-frontend
    repo: https://github.com/Jemershon/Capstone-2
    branch: main
    buildCommand: cd frontend/react-app && npm ci --no-audit --no-fund && npm run build
    publishPath: frontend/react-app/dist
    env:
      VITE_API_URL: "https://capstone-backend.onrender.com"

  - type: web
    name: capstone-backend
    repo: https://github.com/Jemershon/Capstone-2
    branch: main
    env:
      NODE_ENV: production
  rootDirectory: backend
  buildCommand: bash -lc 'if [ -f ./server.js ]; then echo "server in current dir"; elif [ -f backend/server.js ]; then cd backend; fi; npm ci --no-audit --no-fund'
  startCommand: bash -lc 'if [ -f ./server.js ]; then echo "server in current dir"; elif [ -f backend/server.js ]; then cd backend; fi; npm start'
    plan: starter